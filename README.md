# Tharawat: Your Smart Gateway to Gulf Investments

## Project Description

**Tharawat** (Arabic for "Wealth") is an intelligent, AI-powered financial platform designed to empower investors interested in the Gulf Cooperation Council (GCC) markets. The application serves as a comprehensive toolkit, providing users with personalized investment strategies, real-time market analysis, and robust portfolio management capabilities, all delivered through a clean, modern, and intuitive Arabic-first user interface.

The platform's core mission is to democratize access to sophisticated financial insights by leveraging cutting-edge generative AI, making it easier for both novice and experienced investors to explore opportunities, understand market dynamics, and track their financial goals.

---

## Core Capabilities

*   **AI-Powered Investment Guide:** Users can input their financial goals, capital, and risk tolerance to receive a custom, comprehensive investment strategy generated by an AI financial advisor.
*   **Intelligent Market Analyst:** Provides instant, in-depth analysis of any GCC stock. The AI agent scrapes live financial data and news, summarizes its findings, and offers a clear "Buy," "Sell," or "Hold" recommendation with a confidence score.
*   **Dynamic Portfolio Management:** Authenticated users can create and manage multiple investment portfolios, add various asset types (stocks, real estate, etc.), and track their performance against real-time market data.
*   **Watchlist and Stock Details:** Users can maintain a personalized watchlist of assets and dive deep into detailed pages for each stock, viewing historical performance charts and AI-summarized news.
*   **Automated Market Data Updates:** A scheduled backend function runs daily to scrape and update stock prices, ensuring the data powering the application remains current.
*   **Secure User Authentication:** Provides a complete authentication system for user sign-up, login, and profile management, securing all personal data like portfolios and saved strategies.

---

## Application Architecture

The application is built on a modern, serverless technology stack designed for scalability, security, and performance.

*   **Frontend:**
    *   **Framework:** **Next.js** with the App Router.
    *   **Language:** **TypeScript**.
    *   **UI Library:** **ShadCN UI** for beautifully designed, accessible components.
    *   **Styling:** **Tailwind CSS** for a utility-first styling approach.
    *   **Hosting:** Deployed on **Firebase Hosting**, integrated with the Next.js framework for optimal performance.

*   **Backend:**
    *   **Environment:** **Firebase Cloud Functions**.
    *   **Language:** **TypeScript**.
    *   **Scheduled Jobs:** A 24-hour scheduled function (`onSchedule`) automatically updates market data.
    *   **Callable Functions:** Secure HTTPS-callable functions (`onCall`) allow authenticated users to trigger backend processes, such as the manual price update from the Admin Panel.

*   **Database:**
    *   **Service:** **Cloud Firestore** (NoSQL Database).
    *   **Data Structure:**
        *   `/users/{userId}`: Stores user-specific information, including their profile and watchlist.
        *   `/users/{userId}/portfolios/{portfolioId}`: A subcollection for user-created investment portfolios.
        *   `/users/{userId}/strategies/{strategyId}`: A subcollection for AI-generated strategies that the user has saved.
        *   `/saudi_stocks/{ticker}`: A public collection containing the latest price data for stocks, updated by the backend.
    *   **Security:** Firestore Security Rules ensure users can only access their own data, while allowing read-only access to public market data.

*   **AI & External Services:**
    *   **AI Orchestration:** **Genkit** is used to define, run, and manage all AI flows.
    *   **Language Models:** **Google's Gemini models** (e.g., Gemini 1.5 Flash) power the AI financial advisor and market analyst.
    *   **Web Scraping:** **Firecrawl** is used by the backend functions to scrape live financial data from the web.

---

## Key Workflows

1.  **AI Investment Guide Workflow:**
    *   A user on the "Investment Guide" page enters their financial details into a form.
    *   The form data is sent to the `generateInvestmentStrategy` Genkit flow.
    *   The AI flow, acting as a financial expert, processes the inputs, uses tools like `getRealEstatePrice` if needed, and generates a structured JSON output containing a full investment plan.
    *   The plan is displayed to the user and automatically saved to their profile in the `/users/{userId}/strategies` collection if they are logged in.

2.  **AI Market Analyst Workflow:**
    *   A user on the "Market Analyst" page enters a company name or ticker.
    *   This query is sent to the `analyzeMarketForTicker` Genkit flow.
    *   The flow first uses the `findCompanyNameTool` to resolve the query to a specific ticker and company name.
    *   It then uses the `findFinancialData` tool, which leverages Firecrawl to scrape the latest financial news and data for that company.
    *   The scraped text is passed to the "Tharawat" analyst prompt. The AI analyzes the text, summarizes it, and generates a structured recommendation.
    *   The final analysis is returned to the user and displayed on the page.

3.  **Portfolio Management Workflow:**
    *   An authenticated user creates a new portfolio, which creates a new document in `/users/{userId}/portfolios`.
    *   The user adds an asset to their portfolio. The frontend uses an AI tool (`findMarketAssetsTool`) to help find valid stocks.
    *   When an asset is added, a new document is created in the `/users/{userId}/portfolios/{portfolioId}/assets` subcollection.
    *   The portfolio page fetches the user's assets and then uses `getStockPriceFromFirestore` to pull the latest prices from the public `saudi_stocks` collection to calculate the portfolio's current value and performance.

4.  **Automated Data Update Workflow:**
    *   Every 24 hours, the `updateStockPrices` Cloud Function is automatically triggered by Cloud Scheduler.
    *   The function runs the `updateAllMarketPrices` task, which uses Firecrawl to scrape the Saudi Exchange website.
    *   It extracts all stock tickers and their latest prices.
    *   It then iterates through the scraped data and writes each stock's information as a document in the `saudi_stocks` collection in Firestore, overwriting the previous day's data. This can also be triggered manually from the Admin page.
